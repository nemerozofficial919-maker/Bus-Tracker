<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Device Sender</title>
</head>
<body>
<h2>Send Your Location</h2>
<label>Name: <input id="name" placeholder="Bus 1"></label><br>
<label>Number: <input id="number" placeholder="12345"></label><br>
<button onclick="startTracking()">Start Tracking</button>

<script>
const SERVER_URL = "https://bus-tracker-mqrq.onrender.com"; // your Render URL
let deviceId = Date.now(); // unique per device
let interval;

function sendLocation(position) {
  const name = document.getElementById("name").value || "Unknown";
  const number = document.getElementById("number").value || "N/A";

  fetch(`${SERVER_URL}/update`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      id: deviceId,
      name: name,
      number: number,
      lat: position.coords.latitude,
      lon: position.coords.longitude
    })
  });
}

function startTracking() {
  if (interval) return; // already running
  function track() {
    navigator.geolocation.getCurrentPosition(sendLocation);
  }
  track(); // run immediately
  interval = setInterval(track, 5000);
  alert("Tracking started!");
}
</script>
</body>
</html>
