<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bus GPS Sender</title>
</head>
<body>
<h2>Bus GPS Sender</h2>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script>
const SERVER_URL = "https://bus-tracker-mqrq.onrender.com"; // Your Render URL
const DEVICE_ID = "bus-1"; // Change for each bus if multiple

// Function to send GPS to server
function sendLocation(position) {
  fetch(`${SERVER_URL}/update`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      id: DEVICE_ID,
      lat: position.coords.latitude,
      lon: position.coords.longitude,
      ts: Date.now()
    })
  });
}

// Track location every few seconds
function trackBus() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(sendLocation, (err) => {
      console.error("Error getting location:", err);
    });
  }
}

// Update every 5 seconds
setInterval(trackBus, 5000);
trackBus(); // Start immediately
</script>
</body>
</html>
